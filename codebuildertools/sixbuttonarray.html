<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NBI – Multi-Button Bulk Editor</title>
<style>
  :root { --ink:#0f172a; --muted:#6b7280; --bg:#f6f7fb; --card:#ffffff; --brand:#25408F; }
  * { box-sizing:border-box }
  body { margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; background:var(--bg); color:var(--ink); }
  header { padding:16px 20px; background:var(--brand); color:#fff; }
  header h1 { margin:0; font-size:28px; line-height:1.1; }
  header p { margin:2px 0 8px; opacity:.9 }
  nav .nav-tabs { list-style:none; padding:0; margin:0; display:flex; gap:18px; }
  nav .nav-tabs a { color:#fff; text-decoration:none; font-weight:600 }
  .dropdown { position:relative }
  .dropdown-menu { display:none; position:absolute; background:#13306e; padding:8px; border-radius:8px; list-style:none; margin-top:6px; min-width:220px }
  .dropdown:hover .dropdown-menu { display:block }
  .dropdown-menu a { display:block; padding:6px 8px }

  .wrap { display:grid; grid-template-columns: 460px 1fr; gap:18px; padding:18px; max-width:1100px; margin:0 auto; }
  .card { background:var(--card); border-radius:12px; box-shadow:0 8px 24px rgba(2,6,23,.06); }
  .card h2 { margin:0; padding:14px 16px; font-size:16px; border-bottom:1px solid #e5e7eb; }
  .card .body { padding:14px 16px; }

  .row { display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-bottom:10px; }
  .row.full { grid-template-columns:1fr; }
  label { font-size:12px; color:var(--muted); display:block; margin-bottom:6px; }
  input[type="text"], input[type="number"], input[type="url"], select {
    width:100%; padding:8px 10px; border:1px solid #d1d5db; border-radius:8px; font-size:14px;
  }
  input[type="color"] { width:100%; height:36px; padding:0; border:1px solid #d1d5db; border-radius:8px; }
  .actions { display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
  button { appearance:none; border:0; background:#111827; color:#fff; padding:9px 12px; border-radius:10px; cursor:pointer; font-weight:600; }
  button.secondary { background:#334155; }
  textarea { width:100%; min-height:160px; font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace; font-size:12.5px; padding:12px; border:1px solid #d1d5db; border-radius:8px; }

  .preview-pane { padding:20px; }
  .preview-note { font-size:12px; color:var(--muted); margin-bottom:8px; }
  .email-frame { background:#fff; border:1px solid #e5e7eb; border-radius:10px; padding:16px; overflow:auto; }

  /* Checklist */
  .selectall { display:flex; align-items:center; gap:10px; margin-bottom:10px; }
  .btn-list { display:grid; gap:8px; margin-bottom:12px; }
  .btn-item { display:grid; grid-template-columns: 24px 1fr; gap:10px; padding:8px; border:1px solid #e5e7eb; border-radius:10px; background:#f9fafb; }
  .btn-meta { display:flex; flex-direction:column; gap:6px; }
  .btn-top { display:flex; gap:8px; align-items:center; }
  .btn-top code { white-space:nowrap; overflow:hidden; text-overflow:ellipsis; max-width:220px; }
  .btn-url { display:grid; grid-template-columns: 1fr auto; gap:8px; }
  .muted { color:var(--muted) }
</style>
<link rel="stylesheet" href="../style.css" />
</head>
<body>
<header>
  <h1>NBICodeAcademy</h1>
  <p>by New Blue Interactive</p>
  <nav>
    <ul class="nav-tabs">
      <li><a href="../index.html">Home</a></li>

      <li class="dropdown">
        <a href="../tools.html">NBI Email Tools ▾</a>
        <ul class="dropdown-menu">
          <li><a href="../EmailChecklist.html">Email Checklist</a></li>
          <li><a href="../snippetlibrary.html">Snippet Library</a></li>
          <li><a href="../codebuildertools/choosethetool.html">Email Link Library</a></li>
          <li><a href="../codebuildertools/SocialIconsite/socialiconcolor.html">Social Icon Tool</a></li>
        </ul>
      </li>

      <li class="dropdown">
        <a href="../trainings.html">Trainings ▾</a>
        <ul class="dropdown-menu">
          <li><a href="trainings.html#workshops">Workshops</a></li>
          <li><a href="trainings.html#videos">Video Library</a></li>
        </ul>
      </li>

      <li><a href="../docs.html">Documentation</a></li>
    </ul>
  </nav>
</header>

<div class="wrap">
  <!-- LEFT: Editor + checklist -->
  <section class="card">
    <h2>Editor</h2>
    <div class="body">
      <!-- Button checklist -->
      <div class="selectall">
        <input id="toggleAll" type="checkbox" />
        <label for="toggleAll"><strong>Select all buttons</strong></label>
      </div>
      <div id="buttonList" class="btn-list"></div>

      <!-- Controls -->
      <div class="row">
        <div>
          <label>Background color</label>
          <input type="color" id="bg" value="#2196F3" />
        </div>
        <div>
          <label>Text color</label>
          <input type="color" id="fg" value="#ffffff" />
        </div>
      </div>

      <div class="row">
        <div>
          <label>Font size (px)</label>
          <input type="number" id="fs" min="10" step="1" value="18" />
        </div>
        <div>
          <label>Width (px)</label>
          <input type="number" id="w" min="120" step="1" value="273" />
        </div>
      </div>

      <div class="row">
        <div>
          <label>Line height (px)</label>
          <input type="number" id="lh" min="24" step="1" value="50" />
        </div>
        <div>
          <label>Border radius (px)</label>
          <input type="number" id="br" min="0" step="1" value="7" />
        </div>
      </div>

      <div class="row">
        <div>
          <label>Height (px) — TD wrapper</label>
          <input type="number" id="heightPx" min="20" step="1" value="50" />
        </div>
        <div>
          <label>Underline</label>
          <select id="underline">
            <option value="underline" selected>Underline</option>
            <option value="none">No underline</option>
          </select>
        </div>
      </div>

      <!-- ✨ NEW: Font family -->
      <div class="row full">
        <div>
          <label>Font family</label>
          <select id="fontFamily">
            <option value="Arial, Helvetica, sans-serif" selected>Arial, Helvetica, sans-serif</option>
            <option value="Helvetica, Arial, sans-serif">Helvetica, Arial, sans-serif</option>
            <option value="'Segoe UI', Arial, sans-serif">'Segoe UI', Arial, sans-serif</option>
            <option value="Georgia, serif">Georgia, serif</option>
            <option value="Tahoma, Geneva, sans-serif">Tahoma, Geneva, sans-serif</option>
          </select>
        </div>
      </div>

      <div class="row full">
        <div>
          <label>Replace button text (optional)</label>
          <input type="text" id="btnText" placeholder="Leave blank to keep current text" />
        </div>
      </div>

      <div class="row full">
        <div>
          <label>Set/replace URL “amount” parameter (optional)</label>
          <input type="number" id="amount" min="1" step="1" placeholder="e.g., 5 or 25" />
        </div>
      </div>

      <div class="actions">
        <button id="apply">Apply to selected</button>
        <button class="secondary" id="resetAll">Reset to original</button>
      </div>
    </div>
  </section>

  <!-- RIGHT: Preview -->
  <section class="card">
    <h2>Live Preview</h2>
    <div class="body preview-pane">
      <div class="preview-note">
        Uses your snippet below. VML/MSO stays intact. Only the regular <code>&lt;a&gt;</code> buttons are edited.
      </div>
      <div id="preview" class="email-frame"></div>
    </div>
  </section>

  <!-- Export -->
  <section class="card" style="grid-column: 1 / span 2;">
    <h2>Export HTML</h2>
    <div class="body">
      <textarea id="exportHtml" readonly></textarea>
      <div class="actions">
        <button id="copyHtml">Copy HTML</button>
        <button class="secondary" id="refreshHtml">Refresh Export</button>
      </div>
    </div>
  </section>
</div>

<!-- === YOUR EXACT CODE SNIPPET (no "Input N:" labels present) === -->
<template id="raw">

<table border="0" cellspacing="0" cellpadding="0" width="100%">
  <tr>
    <td align="center" style="text-align:center;" width="100%">
      <center>
        <table border="0" cellspacing="0" cellpadding="0" style="display:inline-block; text-align:center;">
          <tbody>
            <tr>
              <td align="center" colspan="2" style="text-align:center;">
                <span style="color:#666; font-size:13px; font-style:italic; text-align:center; width:100%; display:block;">
                  If you’ve saved your payment info with ActBlue, your contribution will be processed immediately.
                </span>
              </td>
            </tr>

            <!-- Row 1: $5 and $10 -->
            <tr>
              <td style="display:inline-block; padding:8px;">
                <!--[if mso]>
                <v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="https://secure.actblue.com/donate/example?refcode=emailonacid&amounts=5,10,25,50,100&amount=5&express_lane=true" style="height:50px; width:273px; v-text-anchor:middle;" arcsize="18%" fillcolor="#2196F3" stroke="f">
                  <w:anchorlock/>
                  <center style="color:#ffffff; font-family:Arial, Helvetica, sans-serif; font-size:18px; font-weight:bold; text-decoration:underline;">
                    Donate $5 right now
                  </center>
                </v:roundrect>
                <![endif]-->
                <!--[if !mso]><!-- -->
                <a href="https://secure.actblue.com/donate/example?refcode=emailonacid&amounts=5,10,25,50,100&amount=5&express_lane=true" 
                   style="display:inline-block; background-color:#2196F3; color:#ffffff; font-family:Arial, Helvetica, sans-serif; font-weight:bold; font-size:18px; line-height:50px; width:273px; text-align:center; text-decoration:underline; border-radius:7px; -webkit-text-size-adjust:none;">
                  Donate $5 right now
                </a>
                <!--<![endif]-->
              </td>

              <td style="display:inline-block; padding:8px;">
                <!--[if mso]>
                <v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="https://secure.actblue.com/donate/example?refcode=emailonacid&amounts=5,10,25,50,100&amount=10&express_lane=true" style="height:50px; width:273px; v-text-anchor:middle;" arcsize="18%" fillcolor="#2196F3" stroke="f">
                  <w:anchorlock/>
                  <center style="color:#ffffff; font-family:Arial, Helvetica, sans-serif; font-size:18px; font-weight:bold; text-decoration:underline;">
                    Donate $10 right now
                  </center>
                </v:roundrect>
                <![endif]-->
                <!--[if !mso]><!-- -->
                <a href="https://secure.actblue.com/donate/example?refcode=emailonacid&amounts=5,10,25,50,100&amount=10&express_lane=true" 
                   style="display:inline-block; background-color:#2196F3; color:#ffffff; font-family:Arial, Helvetica, sans-serif; font-weight:bold; font-size:18px; line-height:50px; width:273px; text-align:center; text-decoration:underline; border-radius:7px; -webkit-text-size-adjust:none;">
                  Donate $10 right now
                </a>
                <!--<![endif]-->
              </td>
            </tr>

            <!-- Row 2: $25 and $50 -->
            <tr>
              <td style="display:inline-block; padding:8px;">
                <!--[if mso]>
                <v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="https://secure.actblue.com/donate/example?refcode=emailonacid&amounts=5,10,25,50,100&amount=25&express_lane=true" style="height:50px; width:273px; v-text-anchor:middle;" arcsize="18%" fillcolor="#2196F3" stroke="f">
                  <w:anchorlock/>
                  <center style="color:#ffffff; font-family:Arial, Helvetica, sans-serif; font-size:18px; font-weight:bold; text-decoration:underline;">
                    Donate $25 right now
                  </center>
                </v:roundrect>
                <![endif]-->
                <!--[if !mso]><!-- -->
                <a href="https://secure.actblue.com/donate/example?refcode=emailonacid&amounts=5,10,25,50,100&amount=25&express_lane=true" 
                   style="display:inline-block; background-color:#2196F3; color:#ffffff; font-family:Arial, Helvetica, sans-serif; font-weight:bold; font-size:18px; line-height:50px; width:273px; text-align:center; text-decoration:underline; border-radius:7px; -webkit-text-size-adjust:none;">
                  Donate $25 right now
                </a>
                <!--<![endif]-->
              </td>

              <td style="display:inline-block; padding:8px;">
                <!--[if mso]>
                <v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="https://secure.actblue.com/donate/example?refcode=emailonacid&amounts=5,10,25,50,100&amount=50&express_lane=true" style="height:50px; width:273px; v-text-anchor:middle;" arcsize="18%" fillcolor="#2196F3" stroke="f">
                  <w:anchorlock/>
                  <center style="color:#ffffff; font-family:Arial, Helvetica, sans-serif; font-size:18px; font-weight:bold; text-decoration:underline;">
                    Donate $50 right now
                  </center>
                </v:roundrect>
                <![endif]-->
                <!--[if !mso]><!-- -->
                <a href="https://secure.actblue.com/donate/example?refcode=emailonacid&amounts=5,10,25,50,100&amount=50&express_lane=true" 
                   style="display:inline-block; background-color:#2196F3; color:#ffffff; font-family:Arial, Helvetica, sans-serif; font-weight:bold; font-size:18px; line-height:50px; width:273px; text-align:center; text-decoration:underline; border-radius:7px; -webkit-text-size-adjust:none;">
                  Donate $50 right now
                </a>
                <!--<![endif]-->
              </td>
            </tr>

            <!-- Row 3: $100 and other -->
            <tr>
              <td style="display:inline-block; padding:8px;">
                <!--[if mso]>
                <v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="https://secure.actblue.com/donate/example?refcode=emailonacid&amounts=5,10,25,50,100&amount=100&express_lane=true" style="height:50px; width:273px; v-text-anchor:middle;" arcsize="18%" fillcolor="#2196F3" stroke="f">
                  <w:anchorlock/>
                  <center style="color:#ffffff; font-family:Arial, Helvetica, sans-serif; font-size:18px; font-weight:bold; text-decoration:underline;">
                    Donate $100 right now
                  </center>
                </v:roundrect>
                <![endif]-->
                <!--[if !mso]><!-- -->
                <a href="https://secure.actblue.com/donate/example?refcode=emailonacid&amounts=5,10,25,50,100&amount=100&express_lane=true" 
                   style="display:inline-block; background-color:#2196F3; color:#ffffff; font-family:Arial, Helvetica, sans-serif; font-weight:bold; font-size:18px; line-height:50px; width:273px; text-align:center; text-decoration:underline; border-radius:7px; -webkit-text-size-adjust:none;">
                  Donate $100 right now
                </a>
                <!--<![endif]-->
              </td>

              <td style="display:inline-block; padding:8px;">
                <!--[if mso]>
                <v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" href="https://secure.actblue.com/donate/example?refcode=emailonacid&amounts=5,10,25,50,100" style="height:50px; width:273px; v-text-anchor:middle;" arcsize="18%" fillcolor="#2196F3" stroke="f">
                  <w:anchorlock/>
                  <center style="color:#ffffff; font-family:Arial, Helvetica, sans-serif; font-size:18px; font-weight:bold; text-decoration:underline;">
                    Donate another amount
                  </center>
                </v:roundrect>
                <![endif]-->
                <!--[if !mso]><!-- -->
                <a href="https://secure.actblue.com/donate/example?refcode=emailonacid&amounts=5,10,25,50,100" 
                   style="display:inline-block; background-color:#2196F3; color:#ffffff; font-family:Arial, Helvetica, sans-serif; font-weight:bold; font-size:18px; line-height:50px; width:273px; text-align:center; text-decoration:underline; border-radius:7px; -webkit-text-size-adjust:none;">
                  Donate another amount
                </a>
                <!--<![endif]-->
              </td>
            </tr>
          </tbody>
        </table>
      </center>
    </td>
  </tr>
</table>
</template>

<script>
/* ---------- Utilities ---------- */
const $ = (id) => document.getElementById(id);

function setUrlAmount(url, amountVal) {
  if (amountVal === '' || amountVal == null) return url;
  try {
    const u = new URL(url, location.origin);
    u.searchParams.set('amount', String(Number(amountVal)));
    return u.href.replace(u.origin, '');
  } catch {
    const has = /([?&])amount=\d+/.test(url);
    if (has) return url.replace(/([?&])amount=\d+/, '$1amount=' + Number(amountVal));
    return url + (url.includes('?') ? '&' : '?') + 'amount=' + Number(amountVal);
  }
}

function getAnchors() {
  return [...$('preview').querySelectorAll('a[href]')];
}

/* ---------- Load snippet ---------- */
function loadSnippet() {
  const raw = $('raw').innerHTML;
  $('preview').innerHTML = raw; // exact code
  buildChecklist();
  refreshExport();
}

/* ---------- Checklist with per-button URL editing ---------- */
function buildChecklist() {
  const list = $('buttonList');
  list.innerHTML = '';
  const anchors = getAnchors();

  anchors.forEach((a, i) => {
    const id = 'btn_' + i;
    const urlId = 'url_' + i;

    const div = document.createElement('div');
    div.className = 'btn-item';
    div.innerHTML = `
      <input type="checkbox" id="${id}" class="sel" data-idx="${i}" />
      <div class="btn-meta">
        <div class="btn-top">
          <label for="${id}"><strong>${(a.textContent||'').trim() || 'Button ' + (i+1)}</strong></label>
          <span class="muted">—</span>
          <code id="code_${i}">${a.getAttribute('href')}</code>
        </div>
        <div class="btn-url">
          <input type="url" id="${urlId}" value="${a.getAttribute('href')}" />
          <button type="button" data-idx="${i}" class="setUrl">Set URL</button>
        </div>
      </div>
    `;
    list.appendChild(div);
  });

  // Handle individual URL set (click) and live update on blur/Enter
  list.querySelectorAll('.setUrl').forEach(btn => {
    btn.addEventListener('click', (e) => {
      const idx = Number(e.currentTarget.dataset.idx);
      const input = $('url_' + idx);
      updateHref(idx, input.value);
    });
  });
  list.querySelectorAll('input[type="url"]').forEach(inp => {
    inp.addEventListener('blur', (e) => {
      const idx = Number(e.target.id.split('_')[1]);
      updateHref(idx, e.target.value);
    });
    inp.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        const idx = Number(e.target.id.split('_')[1]);
        updateHref(idx, e.target.value);
      }
    });
  });

  // Sync "Select all" with individuals
  list.querySelectorAll('.sel').forEach(cb => cb.addEventListener('change', syncToggleAll));
  syncToggleAll();
}

function updateHref(idx, newUrl) {
  const a = getAnchors()[idx];
  if (!a) return;
  try { a.setAttribute('href', newUrl); } catch {}
  const codeEl = $('code_' + idx);
  const urlInput = $('url_' + idx);
  if (codeEl) codeEl.textContent = newUrl;
  if (urlInput && urlInput.value !== newUrl) urlInput.value = newUrl;
  refreshExport();
}

/* ---------- Selection helpers ---------- */
function getSelectedAnchors() {
  const picks = [...document.querySelectorAll('.sel:checked')].map(cb => Number(cb.dataset.idx));
  const anchors = getAnchors();
  return picks.map(i => anchors[i]).filter(Boolean);
}
function syncToggleAll() {
  const boxes = [...document.querySelectorAll('.sel')];
  const all = $('toggleAll');
  if (!boxes.length) { all.checked = false; all.indeterminate = false; return; }
  const checked = boxes.filter(b => b.checked).length;
  all.checked = checked === boxes.length;
  all.indeterminate = checked > 0 && checked < boxes.length;
}

/* ---------- Apply bulk edits ---------- */
function applyEdits() {
  const targets = getSelectedAnchors();
  if (!targets.length) { alert('Select one or more buttons first.'); return; }

  const bg = $('bg').value, fg = $('fg').value, fs = $('fs').value, w = $('w').value,
        lh = $('lh').value, br = $('br').value, h = $('heightPx').value,
        deco = $('underline').value, txt = $('btnText').value.trim(), amt = $('amount').value.trim(),
        ff = $('fontFamily').value;                 // <-- NEW font family

  targets.forEach(a => {
    if (bg) a.style.backgroundColor = bg;
    if (fg) a.style.color = fg;
    if (fs) a.style.fontSize = Number(fs) + 'px';
    if (w)  a.style.width = Number(w) + 'px';
    if (lh) a.style.lineHeight = Number(lh) + 'px';
    if (br) a.style.borderRadius = Number(br) + 'px';
    if (deco) a.style.textDecoration = deco;
    if (ff) a.style.fontFamily = ff;               // <-- apply font family

    if (h) {
      const td = a.closest('td');
      if (td) td.setAttribute('height', String(Number(h)));
    }

    if (txt) a.textContent = txt;
    if (amt) a.setAttribute('href', setUrlAmount(a.getAttribute('href')||'', amt));
  });

  // Keep checklist intact; update visible URLs.
  getAnchors().forEach((a, i) => {
    const codeEl = $('code_' + i);
    if (codeEl) codeEl.textContent = a.getAttribute('href');
    const urlInput = $('url_' + i);
    if (urlInput && urlInput.value !== a.getAttribute('href')) {
      urlInput.value = a.getAttribute('href');
    }
  });

  refreshExport();
}

/* ---------- Export / reset ---------- */
function refreshExport(){ $('exportHtml').value = $('preview').innerHTML.trim(); }
function copyExport(){
  const t = $('exportHtml').value;
  navigator.clipboard.writeText(t).then(()=>alert('HTML copied!'))
    .catch(()=>{ $('exportHtml').select(); document.execCommand('copy'); alert('HTML copied (fallback).'); });
}
function resetAll(){
  loadSnippet();
  $('toggleAll').checked = false;
  $('toggleAll').indeterminate = false;
}

/* ---------- Wire up ---------- */
$('apply').addEventListener('click', applyEdits);
$('resetAll').addEventListener('click', resetAll);
$('refreshHtml').addEventListener('click', refreshExport);
$('copyHtml').addEventListener('click', copyExport);
$('toggleAll').addEventListener('change', (e) => {
  document.querySelectorAll('.sel').forEach(cb => { cb.checked = e.target.checked; });
  syncToggleAll();
});

/* ---------- Init ---------- */
loadSnippet();
</script>
</body>
</html>
